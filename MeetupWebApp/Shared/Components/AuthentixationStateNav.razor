@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims
@inject NavigationManager NavigationManager
@inherits BaseComponent
@rendermode InteractiveServer

<ul class="navbar-nav ms=auto">
    @if (base.IsAuthentdicated)
    {
        
        <li class="nav-item">
            <a class="nav-link text-light" href="@($"/users/{base.UserId}/manage-rsvp-events")">Hello, @base.Username</a>

        </li>
        <li class="nav-item">
            <a class="nav-link text-light btn btn-link" @onclick="Logout">Logout</a>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link text-light btn btn-link" @onclick="Login">Login</a>
        </li>
    }
</ul>

<DialogComponent @ref="DialogComp" Title="Sign in">

    <Content>
        <ExternalLoginButtonsComponent></ExternalLoginButtonsComponent>
    </Content>
</DialogComponent>



@code{

    DialogComponent DialogComp = new();

    public void Login()
    {
        DialogComp.ShowModel();
    }

    public void Logout()
    {
        var redirectUrl = NavigationManager.Uri.ToString();
        var EncodedRedirectUri = HttpUtility.UrlEncode(redirectUrl);

        NavigationManager.NavigateTo($"/logout?redirecturl={EncodedRedirectUri}", true);
    }
}